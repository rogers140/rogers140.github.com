<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 如何在input标签上传文件之前获得文件大小？ · r14o</title><meta name="description" content="如何在input标签上传文件之前获得文件大小？ - Ruogu Liu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://rogers140.github.io/atom.xml" title="r14o"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://www.linkedin.com/in/ruogu-liu-8a120456" target="_blank" class="nav-list-link">LINKEDIN</a></li><li class="nav-list-item"><a href="https://github.com/rogers140" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">如何在input标签上传文件之前获得文件大小？</h1><div class="post-info">Mar 2, 2013</div><div class="post-content"><p>周四又整那个网站呢，遇到一个问题，就是要限制用户上传图片的大小，如果太大的话，比如超过300K之后就弹出提示窗口。<br><a id="more"></a><br>一开始觉得还挺简单的，而且想到了两个思路，一个是在前台检验，用js或者html5；另一个是在后台检测，php似乎也有类似的函数可以实现。但在网上搜了一下，很多例子都用不了，而且还有各种浏览器兼容的问题，考虑到我们已经鼓励用户用Chrome和Firefox了，而且如果传到后台再检测其实是拿不到文件的，因为在前台现限制了大小。于是只能用前台检测方法了，最后决定用这个：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleFileSelect</span>(<span class="params">evt</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> files = evt.target.files; <span class="comment">// FileList object</span></div><div class="line">    <span class="keyword">if</span>(files[<span class="number">0</span>].size&lt;<span class="number">400000</span>)&#123;</div><div class="line">        alert(<span class="string">"文件大小超过300k！请重新选择！"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">'thepic'</span>).addEventListener(<span class="string">'change'</span>, handleFileSelect, <span class="literal">false</span>); <span class="comment">//其中thepic里填写需要的标签id</span></div></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"thepic"</span> <span class="attr">multiple</span>&gt;</span></div></pre></td></tr></table></figure>
<p>经过测试可用。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2013/12/02/houjie-cpp-notes/" class="prev">上一篇</a><a href="/2013/02/11/vsftpd-ftp/" class="next">下一篇</a></div><div class="copyright"><p>© 2012 - 2016 <a href="https://rogers140.github.io">Ruogu Liu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>