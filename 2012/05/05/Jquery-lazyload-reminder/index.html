<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> JQuery的图片延迟加载的提醒 · r140</title><meta name="description" content="JQuery的图片延迟加载的提醒 - Ruogu Liu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://rogers140.github.io/atom.xml" title="r140"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">JQuery的图片延迟加载的提醒</h1><div class="post-info">May 5, 2012</div><div class="post-content"><p>以前没写过我做网站的事儿，这次就顺便说说。第一次做网站，是为南京ComicJehad做，为南京动漫爱好者和动漫产品生产商提供服务。给2800，当时觉得还挺多的，第一次，没经验，以为挺简单一个网站。后来发现网站的逻辑真心不简单，问题也很多。我和圣圣在2012年的夏天完成了第一版（玛达我debug的时候某人竟然在dota！）。那一版能用，但问题很多，经不起考验，安全性几乎没有。以至于我到了瑞典花天酒地还要惦记着远程给这个网站debug。我去当时真是什么奇葩的bug都有。</p>
<p>最近那个老板又说要改一些地方，我果断开口2000，圣圣却主张500，最后弄成1000，玛达你做那么个小东西人家就给了1800，这个能不多要点儿？算了，就当锻炼了。不过说起来这次无非是改改标签，调整下按钮的位置，但觉得收那么些钱改的太少还是不地道，于是我准备对本子信息这个我忍了很久的页面动刀。</p>
<p>它的问题在于load这个页面需要加载很多图片，尽管我限制了上传图片的大小，但是数量一多，加载起来就巨慢。根本无法滚动页面，直到等几十秒，我这么温柔的人都受不了，更不要说用户这么暴躁的物种了。要么分页，要么延迟加载，最后我选了比较酷的延迟加载。</p>
<p>我参考了这个人的<a href="http://www.appelsiini.net/projects/lazyload" target="_blank" rel="external">博客</a>，看了他的demo还不错，测试基本覆盖了主流浏览器。然后开始修改我的代码。试了一下，只能加载前面两行的图，也就是第一个页面看的见的图，后面不管你怎么滚动也加载不了。坑爹呢吧，于是我开始看他插件的源码，写的倒是挺不错的，可惜我对JQuery了解不多，属于那种遇到问题就google的类型，大概看懂他的意思，是说提供了很多的option。比方说默认的使用scroll这个event，就将它绑定到一个container上面，然后监听container是否被滚动来决定调用update()这个函数。看上去很简单吧，可是折腾了我和敏敏一晚上。主要问题就是这个container是什么东西。</p>
<p>开始我以为是window，然后强制捆绑，但是滚动的时候毛线反应都没有啊，搞毛啊！然后我就去睡觉了。第二天敏敏说我div没对齐，多了一个，我就去各种对齐，代码风格不整洁真是没救了。对其完了发现还是多一个，敏敏在inspector下面看到body标签下面多了一个我从来没写过的div，名叫b，卧槽，真是什么情况。也就说滚动的时候不是滚动的我原来container的div，而是滚动最外面那个叫做b的div？一试，果然是这样，终于成功看到延迟加载了！！</p>
<p>写到这里，貌似已经不是技术贴了，不过就想提醒大家注意，以后用这个插件做延迟加载，一定要搞清楚是scroll了哪一个container。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2012/05/05/pyhton-automaticly-gmail-sending/" class="prev">PREV</a><a href="/2012/04/26/just-get-started/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="https://rogers140.github.io">Ruogu Liu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>